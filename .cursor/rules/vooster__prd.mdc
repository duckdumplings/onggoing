---
description:
globs:
alwaysApply: true
---
# 제품 요구사항 문서 (PRD)

## 1. 개요
“옹고잉 최적동선·견적 프로그램”은 사륜차량 기반 물류 서비스를 운영하는 기업이 배송 동선을 최적화하고, 옹고잉 요금제를 기반으로 합리적 견적안을 신속히 생성하도록 돕는 웹·모바일 솔루션이다. 이를 통해 배송 효율 증대, 운영비 절감, 견적 작성 시간 단축을 달성한다.

## 2. 문제 정의
- 현재 배송 동선은 수작업이나 단순 네비게이션으로 계획되어 비효율 발생  
- 실시간 교통정보 반영 부족으로 도착시간 예측 신뢰도가 낮음  
- 복잡한 제약조건(차종, 적재중량, 작업시간 등)을 반영한 자동 배차 도구 부재  
- 견적 산출 시 엑셀·수기 계산에 의존해 오류 및 시간이 과다 소요  

## 3. 목표 및 목적
- 1차 목표: 배송 동선 자동 최적화 및 견적 자동화  
- 2차 목표: 운영 데이터 기반 비용·시간 절감 인사이트 제공  
- 성공 지표  
  - 평균 배차/견적 소요시간 70% 감소  
  - 예상 도착시간 오차 ±5분 이내 90% 달성  

  - 고객사 견적 전환율 30% 이상

## 4. 대상 사용자
### 주요 사용자
- 옹고잉 팀원: 다수 배송원과 배송지를 효율적으로 관리하고 신속한 배차·견적 처리가 필요
- 고객사(화주) 담당자 및 예비 고객사: 옹고잉 홈페이지 임베딩 후 자사 물류비 예측 및 견적 시스템 활용 의향이 높음
### 부차 사용자
- 고객사 담당자: 옹고잉 홈페이지 ‘견적산출기’로 자사 물류비 예측
- 옹고잉 경영진: 운영 KPI 모니터링

## 5. 사용자 스토리
- 물류 운영팀으로서 여러 배송원에게 최적 동선을 자동 배정해 인건비를 절감하고 싶다.  
- (향후) 배송 기사로서 내 배송 순서·예상 도착시간을 확인해 지연을 줄이고 싶다.  
- 고객사 담당자로서 물류 조건을 입력해 즉시 견적서를 받아보고 예산을 확보하고 싶다.  


## 6. 기능 요구사항
### 핵심 기능
1. 최적배차
   - n명의 배송원과 m개 배송지 입력 시 Tmap/Atlan 경로 API로 최단·최소시간 경로 산출
   - 교통 실시간 반영, 적재용량·차종·작업시간 제약 고려
   - 인수기준: 동일 입력 대비 3분 내 결과 표시, 기존 수작업 대비 총 이동거리 10% 이상 감소

2. 시간 최적화(단일 기사)
   - 기사 1명이 정해진 순서를 유지하거나 재정렬하여 최소 소요시간 계산
   - 인수기준: 30개 지점 10초 내 결과, ETA 오차 ±5분

3. 제약조건 모델러
   - 차종(레이, 스타렉스), 적재중량·부피, 경유지 작업시간 입력 UI
   - 제약조건 JSON 스키마 저장/불러오기 지원

4. 견적 자동화
    - 옹고잉 요금제(시간당, 단건 퀵, 건당 고정 요금제) 기반 비용 산정 로직 구현
      - 시간당 요금제: 기본시간 + 시간당 가중치 요금 (예: 2시간 기본, 이후 시간당 10,000원)
      - 단건 퀵 요금제: 단일 목적지 고정 요금 + 거리 추가 요금 (예: 10km까지 15,000원, 이후 km당 1,000원)
      - 건당 요금제: 배송 건당 고정 요금 (예: 건당 8,000원)
      - 차종별 가중치: 레이 1.0, 스타렉스 1.2 등
    - 반응형 웹: 데스크톱·태블릿·모바일 최적화
    - PWA 설치 지원 (iOS UX 제약사항 별도 고려)
      - iOS Safari 전용 온보딩 화면에서 ‘홈에 추가’ 방법 안내
      - iOS PWA 캐시 용량 50MB 제한 반영, 이미지 등 리소스 최소화
      - 백그라운드/오프라인 기능 제한, 수동 새로고침 및 업데이트 안내 제공
      - iOS 16.4 이상 푸시알림 지원, 권한 요청 UX 포함
      - 비밀번호/생체인증, 일부 OS 기능(ARKit, Bluetooth 등) 미지원 안내
   - 인수기준: 견적 생성 10초 이내, 계산 오류율 0.1% 이하

5. 멀티 플랫폼 지원
   - 반응형 웹: 데스크톱·태블릿·모바일 최적화
   - PWA 설치 지원

### 지원 기능
- 다중 시나리오 저장/불러오기
- 관리자 대시보드(사용 현황)

## 7. 비기능 요구사항
- 성능: API 응답 1초 이하, 동시에 2,000 세션 처리
- 보안: OAuth 2.0, JWT, HTTPS, GDPR·개인정보보호법 준수
- 사용성: 온보딩 5분 이내 학습, UI 접근성 WCAG AA
- 확장성: 마이크로서비스 구조, 컨테이너 오토스케일
- 데이터: 배송 기록, 견적 로그, 관리자 계정
- MVP 단계에서는 고객사 정보만 최소화하여 저장, 불필요한 개인정보 수집 금지
- 외부 API: SKT Tmap 다중경유지 API (실시간 교통정보, 최적 경로, 차종/적재 제약 반영)
- 아키텍처: ISR(Incremental Static Regeneration) + Server Actions
- 기타 Mapper’s Atlan API(백업용), Google/Apple 지도는 규제로 한국 내 부적합으로 사용하지 않음
- Tmap 다중경유지(무료 이용 가능 시 우선 활용), 기타 무료 경로 API는 예비 검토
- 백엔드: Supabase(PostgreSQL, Auth, Storage)
- 배포: Vercel + Supabase Region ap-northeast-1
- 외부 API: Tmap 다중경유지, Mapper’s Atlan API
- 아키텍처: ISR(Incremental Static Regeneration) + Server Actions
- 외부 API: Tmap 다중경유지(무료 이용 가능 시 우선 활용), 기타 무료 경로 API 검토
- 3rd Party: PDFKit, ExcelJS, Mapbox GL(View)
- 데이터: 배송 기록, 견적 로그, 관리자 계정 (향후 로그인/권한 모델 확장 예정)
## 9. 성공 지표
- 사용자 채택: MAU, 신규 견적 생성 수
- 비즈니스: 견적→계약 전환율, 평균 배송비 절감률
- 기술: API 오류율 <0.5%, P95 응답시간 <800ms

## 10. 일정 및 마일스톤
- Phase 1 (M+2): MVP—최적배차, 단일 기사 시간 최적화, 기초 견적
- Phase 2 (M+4): 제약조건 모델러, PDF/Excel 견적서, 대시보드
- Phase 3 (M+6): 실시간 위치 추적, 다국어, PWA, AI 예측 강화

## 11. 위험 및 대응
- API 요금 급증: 호출 캐싱, 경로 결과 캐시 TTL 관리  
- 경로 정확도 부족: Tmap·Atlan 복수 알고리즘 비교, 수동 조정 UI  
- 사용자 채택 저조: 무료 체험, 웨비나 교육, 내부 영업 팀 인센티브  
- 데이터 보안: 정기 보안 점검, 침입탐지시스템 연동

## 12. 향후 과제
- AI 기반 수요 예측 후 차량·기사 자동 스케줄링
- 화물 추적 IoT 기기 연동
- SaaS 형태 해외 시장 진출 및 다국통화 결제
- 머신러닝 기반 실시간 요금 조정(혼잡도 반영)


